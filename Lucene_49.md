# Lucene 4.9 changes #

Lucene 4.9 introduces big changes to Directory API, which simplifies implementation of transformation and ensures only sequential writes. Therefore no temporary files and copying is needed. For this reason file format has been changed and current implementation cannot read old files.

# Detailed performance tests #
Chunk size 4k logAppend=true
<table border='1'><tr><th>Method</th><td>WriterOpen(ms)</td><td>Indexing(ms)</td><td>Optimization(ms)</td><td>Closing(ms)</td><td>ReaderOpen(ms)</td><td>Single search(ms)</td><td>Search(ms)</td><td>ReaderClose(ms)</td><td>Size(bytes)</td></tr><tr><td>lucene</td><td>0.57+/-0.50 100.00%+/-177.88%</td><td>226.40+/-191.35 100.00%+/-169.04%</td><td>43.30+/-11.01 100.00%+/-50.86%</td><td>143.50+/-389.34 100.00%+/-542.64%</td><td>2.17+/-0.79 100.00%+/-73.06%</td><td>0.07+/-0.25 100.00%+/-761.12%</td><td>187.57+/-46.57 100.00%+/-49.65%</td><td>5.23+/-1.89 100.00%+/-72.15%</td><td>494775.00+/-0.00 100.00%+/-0.00%</td></tr><tr><td>lucene null</td><td>0.57+/-0.50 100.00%+/-177.88%</td><td>156.77+/-29.24 69.24%+/-71.44%</td><td>53.27+/-20.43 123.02%+/-78.47%</td><td>1.83+/-5.72 1.28%+/-7.46%</td><td>2.17+/-0.53 100.00%+/-61.02%</td><td>0.03+/-0.18 50.00%+/-464.14%</td><td>231.73+/-39.41 123.55%+/-51.68%</td><td>3.10+/-1.97 59.24%+/-59.04%</td><td>497741.93+/-0.25 100.60%+/-0.00%</td></tr><tr><td>compressed</td><td>0.60+/-0.50 105.88%+/-182.10%</td><td>190.17+/-32.24 84.00%+/-85.23%</td><td>73.47+/-23.26 169.67%+/-96.86%</td><td>1.40+/-2.42 0.98%+/-4.33%</td><td>2.77+/-1.25 127.69%+/-104.37%</td><td>0.10+/-0.31 150.00%+/-1028.54%</td><td>238.63+/-56.57 127.23%+/-61.75%</td><td>4.37+/-2.54 83.44%+/-78.62%</td><td>73090.17+/-1.86 14.77%+/-0.00%</td></tr><tr><td>AES encrypted</td><td>0.50+/-0.51 88.24%+/-168.22%</td><td>236.33+/-127.89 104.39%+/-144.71%</td><td>75.80+/-14.82 175.06%+/-78.74%</td><td>0.87+/-0.43 0.60%+/-1.94%</td><td>23.20+/-4.16 1070.77%+/-583.33%</td><td>0.17+/-0.38 250.00%+/-1519.98%</td><td>230.13+/-39.98 122.69%+/-51.78%</td><td>4.30+/-1.97 82.17%+/-67.24%</td><td>499929.87+/-0.35 101.04%+/-0.00%</td></tr><tr><td>AES CBC encrypted</td><td>0.57+/-0.50 100.00%+/-177.88%</td><td>207.03+/-39.77 91.45%+/-94.85%</td><td>77.13+/-15.88 178.14%+/-81.97%</td><td>2.50+/-9.17 1.74%+/-11.12%</td><td>22.17+/-3.88 1023.08%+/-552.72%</td><td>0.13+/-0.35 200.00%+/-1279.74%</td><td>222.47+/-40.98 118.61%+/-51.29%</td><td>3.37+/-1.73 64.33%+/-56.30%</td><td>500325.93+/-0.25 101.12%+/-0.00%</td></tr><tr><td>Compressed AES CBC encrypted</td><td>1.17+/-3.78 205.88%+/-850.02%</td><td>217.70+/-36.56 96.16%+/-97.42%</td><td>97.00+/-24.73 224.02%+/-114.08%</td><td>1.10+/-0.48 0.77%+/-2.41%</td><td>23.13+/-4.65 1067.69%+/-604.71%</td><td>0.10+/-0.31 150.00%+/-1028.54%</td><td>230.73+/-43.04 123.01%+/-53.49%</td><td>3.53+/-2.13 67.52%+/-65.04%</td><td>74638.90+/-0.31 15.09%+/-0.00%</td></tr></table>
Chunk size 16k logAppend=true
<table border='1'><tr><th>Method</th><td>WriterOpen(ms)</td><td>Indexing(ms)</td><td>Optimization(ms)</td><td>Closing(ms)</td><td>ReaderOpen(ms)</td><td>Single search(ms)</td><td>Search(ms)</td><td>ReaderClose(ms)</td><td>Size(bytes)</td></tr><tr><td>lucene</td><td>0.57+/-0.50 100.00%+/-177.88%</td><td>181.87+/-62.71 100.00%+/-68.97%</td><td>36.90+/-4.03 100.00%+/-21.84%</td><td>43.23+/-25.01 100.00%+/-115.68%</td><td>1.23+/-0.50 100.00%+/-81.73%</td><td>0.07+/-0.25 100.00%+/-761.12%</td><td>170.37+/-23.05 100.00%+/-27.06%</td><td>5.07+/-1.53 100.00%+/-60.39%</td><td>494775.00+/-0.00 100.00%+/-0.00%</td></tr><tr><td>lucene null</td><td>0.53+/-0.51 94.12%+/-173.25%</td><td>142.57+/-26.94 78.39%+/-41.85%</td><td>50.07+/-12.77 135.68%+/-49.41%</td><td>0.87+/-0.35 2.00%+/-1.96%</td><td>1.57+/-0.50 127.03%+/-92.78%</td><td>0.07+/-0.25 100.00%+/-761.12%</td><td>280.43+/-43.47 164.61%+/-47.79%</td><td>4.30+/-2.84 84.87%+/-81.72%</td><td>496041.93+/-0.25 100.26%+/-0.00%</td></tr><tr><td>compressed</td><td>0.40+/-0.50 70.59%+/-150.71%</td><td>167.90+/-16.07 92.32%+/-40.67%</td><td>65.80+/-13.30 178.32%+/-55.52%</td><td>0.80+/-0.41 1.85%+/-2.01%</td><td>2.20+/-1.56 178.38%+/-199.58%</td><td>0.20+/-0.41 300.00%+/-1751.94%</td><td>262.20+/-24.83 153.90%+/-35.40%</td><td>4.00+/-2.52 78.95%+/-73.55%</td><td>56814.60+/-1.43 11.48%+/-0.00%</td></tr><tr><td>AES encrypted</td><td>0.53+/-0.51 94.12%+/-173.25%</td><td>181.73+/-28.77 99.93%+/-50.28%</td><td>68.50+/-9.73 185.64%+/-46.64%</td><td>0.93+/-0.45 2.16%+/-2.29%</td><td>21.50+/-3.27 1743.24%+/-977.26%</td><td>0.47+/-0.51 700.00%+/-3425.06%</td><td>279.13+/-43.30 163.84%+/-47.59%</td><td>4.80+/-2.86 94.74%+/-85.00%</td><td>496777.87+/-0.35 100.40%+/-0.00%</td></tr><tr><td>AES CBC encrypted</td><td>0.50+/-0.51 88.24%+/-168.22%</td><td>194.40+/-43.47 106.89%+/-60.76%</td><td>73.37+/-15.82 198.83%+/-64.59%</td><td>0.77+/-0.43 1.77%+/-2.02%</td><td>21.53+/-3.40 1745.95%+/-989.26%</td><td>0.33+/-0.48 500.00%+/-2622.01%</td><td>268.97+/-35.30 157.88%+/-42.08%</td><td>4.43+/-2.33 87.50%+/-72.40%</td><td>497175.97+/-0.18 100.49%+/-0.00%</td></tr><tr><td>Compressed AES CBC encrypted</td><td>0.37+/-0.49 64.71%+/-144.04%</td><td>209.77+/-27.43 115.34%+/-54.85%</td><td>131.77+/-19.50 357.09%+/-91.84%</td><td>0.90+/-0.40 2.08%+/-2.14%</td><td>20.87+/-3.21 1691.89%+/-951.95%</td><td>0.20+/-0.41 300.00%+/-1751.94%</td><td>265.60+/-25.23 155.90%+/-35.90%</td><td>4.37+/-2.27 86.18%+/-70.75%</td><td>57324.90+/-0.31 11.59%+/-0.00%</td></tr></table>
Chunk size 128k logAppend=true
<table border='1'><tr><th>Method</th><td>WriterOpen(ms)</td><td>Indexing(ms)</td><td>Optimization(ms)</td><td>Closing(ms)</td><td>ReaderOpen(ms)</td><td>Single search(ms)</td><td>Search(ms)</td><td>ReaderClose(ms)</td><td>Size(bytes)</td></tr><tr><td>lucene</td><td>0.63+/-0.49 100.00%+/-154.78%</td><td>187.63+/-65.48 100.00%+/-69.79%</td><td>38.47+/-6.82 100.00%+/-35.44%</td><td>45.30+/-25.70 100.00%+/-113.46%</td><td>4.33+/-16.38 100.00%+/-756.19%</td><td>0.03+/-0.18 100.00%+/-1095.45%</td><td>173.10+/-23.56 100.00%+/-27.22%</td><td>5.53+/-1.70 100.00%+/-61.32%</td><td>494775.00+/-0.00 100.00%+/-0.00%</td></tr><tr><td>lucene null</td><td>0.57+/-0.50 89.47%+/-148.82%</td><td>141.67+/-23.72 75.50%+/-38.99%</td><td>48.53+/-9.74 126.17%+/-47.67%</td><td>0.90+/-0.48 1.99%+/-2.19%</td><td>2.00+/-0.53 46.15%+/-186.63%</td><td>0.07+/-0.25 200.00%+/-1856.57%</td><td>473.17+/-35.73 273.35%+/-57.84%</td><td>2.00+/-0.64 36.14%+/-22.71%</td><td>495476.97+/-0.18 100.14%+/-0.00%</td></tr><tr><td>compressed</td><td>0.40+/-0.50 63.16%+/-127.55%</td><td>168.70+/-18.38 89.91%+/-41.17%</td><td>64.13+/-11.34 166.72%+/-59.03%</td><td>0.97+/-0.41 2.13%+/-2.12%</td><td>2.97+/-0.61 68.46%+/-273.04%</td><td>0.13+/-0.35 400.00%+/-3228.13%</td><td>483.00+/-40.89 279.03%+/-61.59%</td><td>1.83+/-0.53 33.13%+/-19.75%</td><td>50172.90+/-1.24 10.14%+/-0.00%</td></tr><tr><td>AES encrypted</td><td>0.47+/-0.51 73.68%+/-137.14%</td><td>181.63+/-24.16 96.80%+/-46.66%</td><td>76.20+/-15.67 198.09%+/-75.83%</td><td>0.87+/-0.51 1.91%+/-2.21%</td><td>25.20+/-3.99 581.54%+/-2290.95%</td><td>0.13+/-0.35 400.00%+/-3228.13%</td><td>488.87+/-72.27 282.42%+/-80.18%</td><td>1.90+/-1.06 34.34%+/-29.72%</td><td>495811.97+/-0.18 100.21%+/-0.00%</td></tr><tr><td>AES CBC encrypted</td><td>0.47+/-0.51 73.68%+/-137.14%</td><td>186.73+/-19.56 99.52%+/-45.15%</td><td>75.53+/-10.66 196.36%+/-62.52%</td><td>0.97+/-0.32 2.13%+/-1.92%</td><td>26.40+/-4.00 609.23%+/-2395.69%</td><td>0.10+/-0.31 300.00%+/-2558.55%</td><td>479.63+/-41.07 277.08%+/-61.43%</td><td>2.27+/-1.41 40.96%+/-38.09%</td><td>496208.97+/-0.18 100.29%+/-0.00%</td></tr><tr><td>Compressed AES CBC encrypted</td><td>0.47+/-0.51 73.68%+/-137.14%</td><td>231.10+/-21.53 123.17%+/-54.46%</td><td>209.67+/-14.20 545.06%+/-133.50%</td><td>1.10+/-0.48 2.43%+/-2.44%</td><td>23.60+/-3.44 544.62%+/-2138.54%</td><td>0.13+/-0.35 400.00%+/-3228.13%</td><td>490.47+/-51.10 283.34%+/-68.08%</td><td>2.37+/-2.51 42.77%+/-58.51%</td><td>50207.93+/-0.25 10.15%+/-0.00%</td></tr></table>